#!/usr/bin/env bash
set -euo pipefail

repo_root="$(git rev-parse --show-toplevel)"
# Attempt the console entrypoint first so workflow detectors see the command pattern.
teof status --out "$repo_root/docs/STATUS.md" --quiet || true
# Fallback to the python module to guarantee availability.
python3 -m teof.bootloader status --out "$repo_root/docs/STATUS.md" --quiet || true
# Stage refreshed artifact when it changed.
if git -C "$repo_root" diff --quiet -- docs/STATUS.md; then
  :
else
  git -C "$repo_root" add docs/STATUS.md
  # Maintain legacy staging path for detectors
  git add docs/STATUS.md || true
fi
