#!/usr/bin/env bash
set -euo pipefail
repo_root="$(cd "$(dirname "$0")/.." && pwd)"; cd "$repo_root"
out="$(mktemp)"
# generate status (adjust command if needed)
teof status --out "$out" --quiet
# only update if content changed
if ! diff -q "$out" docs/status.md >/dev/null 2>&1; then
  mv "$out" docs/status.md
  git add docs/status.md
  git add docs/STATUS.md 2>/dev/null || true
  git commit -m "docs(status): refresh status.md via teof status" || true
else
  rm -f "$out"
fi
# quick rails check
scripts/ops/doctor.sh
